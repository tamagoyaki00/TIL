2025-11-29学習記録
ルーティングのリファクタリングをおこなった。

元のコード。これらは日記一覧の、マイ日記、みんなの日記のルーティング。

```
get "my_diaries", to: "diaries#my_diaries", as: :my_diaries
get "public_diaries", to: "diaries#public_diaries", as: 
```

こちらでも問題はないんですが、コントローラーもdiariesなのでまとめたほうが可読性が上がると思い以下に変更

元々のパスが`my_diaries_path`などで変更後は`my_diaries_diaries_path`になるので少し冗長的なのですが、
URLが`diaries/my`より`diaries/my_diaries`のほうが分かりやすいかなぁと思い、こちらにしました。
```
resources :diaries do
collection do
    get :my_diaries
    get :public_diaries
end

```

またもう一か所。これらのルーティングもpagesコントローラーなのでまとめました。  
変更前
```
get "top", to: "pages#top"
get "diary/writing_tips", to: "pages#diary_writing_tips"
get "privacy_policy", to: "pages#privacy_policy"
get "terms_of_service", to: "pages#terms_of_service"
```

変更後
```
scope controller: :pages do
get :top
get :diary_writing_tips
get :privacy_policy
get :terms_of_service
end

```
これですべてpagesコントローラーにあるんだなと一目でわかるようになりました！

### scope, scope module, namespaceの違い

| 設定        | URLへの影響                  | コントローラのファイル構成への影響 | 典型的な使い方                     |
|-------------|-----------------------------|----------------------------------|----------------------------------|
| **scope**       | 指定のパスにしたい              | 変えたくない                        | 静的ページやトップレベルの整理         |
| **scope module**| 変えたくない                   | 指定のパスにしたい                   | コントローラをモジュール階層に整理       |
| **namespace**   | 指定のパスにしたい              | 指定のパスにしたい                   | 管理画面やAPIなど、URLとコード両方で区別 |


今回はプレフィックスは付けておらず、コントローラーをまとめるためにscopeを使いました。
もしプレフィックスを付けたい場合は
`scope :pages, controller: :pages do`のようにする。

個人的に`scope module`の使い方があまり分からない。。。
コントローラーをモジュール化するのは同じアクションがある場合に区別を付けたいからで、その場合URLも区別付いたほうが分かりやすい気がするけど、裏では分けるけど、表ではわからないようにしたいという場面がどこかででるんだろうなぁ。

