## 2025-10-08学習記録
学習時間7.9時間（総合学習時間1047.3）

TO DO
- [x] アカウント削除時のシステムスペックテスト
- [x] フォームオブジェクトRSpecテスト
  
## 学び
システムスペックのユーザー削除機能に関する記述をしているときに

同じ内容のテストを2つ書いても1つは成功・1つは失敗という結果になった。

### 結論
`login_as` が Devise の削除フローと相性が悪い！

- **Devise の挙動**
    - Devise の `registrations#destroy` は「ユーザー削除 → セッションリセット → root にリダイレクト」という流れ。
    - でも system spec で `login_as` を使うと「セッションリセット」が効かず、リダイレクトが崩れることがある。

削除のテストを書くのであれば、

login_asを使うのではなく、

ログイン画面からログインする記述を書く！

turbo_confirmを利用した際のダイアログの確認が通常のaccept_confirmでは確認がとれない為、ダイアログを常にOKにするという意味の`page.execute_script("window.confirm = () => true") `を追加。page.execute_script("window.confirm = () => true") 

`be_falsey` `nil`や`false`を意味する。
アカウント削除時に、DBから消えてるかどうか確認するときに使った。