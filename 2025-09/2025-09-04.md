## 2025-09-04学習記録
学習時間7.5時間（総合学習時間889.5）

TODO
- [x]  日記投稿のフォームを作成

[![Image from Gyazo](https://i.gyazo.com/3ea6c4306f66af33988b47518296f28b.gif)](https://gyazo.com/3ea6c4306f66af33988b47518296f28b)


日記のフォームは一旦こんな感じで出来上がりました～！！

今回もフォームオブジェクトを使ったんですが、すこーし理解が深まりました。
`include ActiveModel::Model`の説明ってActiveRecordを継承しないクラスでも、ActiveRecordのような便利な機能を使えるようにするモジュールです。って書かれてることが多くて、ふーん(　´_ゝ｀)、要はモデルのように扱えるんだなくらいに思ってたんですけど、initializeメソッドは自動で提供してくれるんですね！！かかないといけないと思ってました。
それに伴い、いつもコントローラーで`post = Post.new`とかで動いているのは、ActiveRecordが裏でinitializeメソッドを自動でやってくれてるからなんだ、ということも理解できました。

また、毎回プルリクエスト書く時に悩む！（今思うとカリキュラムのプルリクエストがてきとうだったと感じる。。）
毎回わかりやすくをかこう！を心がけているとこれも書いたほうがいいか、このほうが見やすいかなど思いつくようになりました！GIFは付けたほうが見やすいですね。

今回はこんな感じに書きました！
プルリクエストの書き方の良し悪しが自分ではわからないので誰かに教えてほしい・・・。

## 実装内容の概要
- ユーザーが日々の幸せを記録・投稿できる日記投稿機能を追加しました。
- ユーザーは公開・非公開を選ぶことができます。
- 日付はデフォルトで日記作成時の日付が入りますが、調整が可能です。例えば、0時を過ぎて日付が変わってしまっても前日分として日記をつけることができます。
- 日記の内容は箇条書きを想定しており、入力フォームを分けています。ユーザーはフォームを増やしたり減らしたりが可能ですが１つめは消すことができない仕様です。（動画参照）
- １，２，３という番号は今後の幸せカウントに利用する予定です。
- 日記の内容はnull: falseですが、1つ目さえ入力していれば、２，３は未入力でも日記の投稿が可能です。
レスポンシブ対応済みです。

上記のGIF＋PC画面のGIF

## 技術的な詳細
- データベース: diaryテーブル・diaries_contentsテーブルを作成。（1対多）

- フォームオブジェクト: DiaryFormを導入し、フォームの内容を一括で管理できるようにしました。
フォームの内容は、posted_date（日付）、status（公開・非公開enum管理）、happiness_items（各フォームの日記の内容を配列で取得）です。

  - カスタムバリデータat_least_one_happiness_present:DB上日記の内容はnull: falseですが、1つ目さえ入力していれば2つ目以降は未入力でもエラーが発生しないように設定。
  - カスタムバリデータhappiness_items_length:各入力フォームの文字が1000文字を超えないように設定。
- Stimulusコントローラー:

  - diary_controller: 「+」ボタンで日記の入力フォームを動的に追加する機能を実装しました。
  - status-selector_controller: 公開・非公開ボタンの選択状態を管理し、非表示のラジオボタンと連携するロジックを実装しました。<template>を使用することで、フォームのデザインを変更したい場合もHTMLのみの修正で済むようになります。
- UI/UX:
  - カレンダーUIにCalyを使用し、ユーザーが直感的に日付を選択できるようにしました。
デフォルトはフォーム入力時の日付が入ります。選択された日付は、非表示のhidden_fieldに保存され、フォーム送信時に処理されます。

## 実行内容
Close #

